

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/dog.png">
  <link rel="icon" href="/img/dog.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#325686">
  <meta name="author" content="ztrura">
  <meta name="keywords" content="">
  
    <meta name="description" content="用于代码生成的语言模型。">
<meta property="og:type" content="article">
<meta property="og:title" content="Code LMs">
<meta property="og:url" content="http://ztrura.com/2023/01/20/codeLMs/index.html">
<meta property="og:site_name" content="Ztrura">
<meta property="og:description" content="用于代码生成的语言模型。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://ztrura.com/2023/01/20/codeLMs/image-20230119133213886.png">
<meta property="og:image" content="http://ztrura.com/2023/01/20/codeLMs/image-20230119212019266.png">
<meta property="og:image" content="http://ztrura.com/2023/01/20/codeLMs/image-20230119162657083.png">
<meta property="og:image" content="http://ztrura.com/2023/01/20/codeLMs/image-20230119212722494.png">
<meta property="og:image" content="http://ztrura.com/2023/01/20/codeLMs/image-20230119213418011.png">
<meta property="og:image" content="http://ztrura.com/2023/01/20/codeLMs/image-20230119214821833.png">
<meta property="og:image" content="http://ztrura.com/2023/01/20/codeLMs/image-20230119215407301.png">
<meta property="og:image" content="http://ztrura.com/2023/01/20/codeLMs/image-20230119220636853.png">
<meta property="og:image" content="http://ztrura.com/2023/01/20/codeLMs/image-20230120110246895.png">
<meta property="og:image" content="http://ztrura.com/2023/01/20/codeLMs/image-20230120110346153.png">
<meta property="og:image" content="http://ztrura.com/2023/01/20/codeLMs/image-20230120111612158.png">
<meta property="og:image" content="http://ztrura.com/2023/01/20/codeLMs/image-20230120111857932.png">
<meta property="og:image" content="http://ztrura.com/2023/01/20/codeLMs/image-20230120112147169.png">
<meta property="og:image" content="http://ztrura.com/2023/01/20/codeLMs/image-20230120112947452.png">
<meta property="og:image" content="http://ztrura.com/2023/01/20/codeLMs/image-20230120125043513.png">
<meta property="og:image" content="http://ztrura.com/2023/01/20/codeLMs/image-20230120125212608.png">
<meta property="og:image" content="http://ztrura.com/2023/01/20/codeLMs/image-20230120134330476.png">
<meta property="og:image" content="http://ztrura.com/2023/01/20/codeLMs/image-20230120161144651.png">
<meta property="og:image" content="http://ztrura.com/2023/01/20/codeLMs/image-20230120171251115.png">
<meta property="og:image" content="http://ztrura.com/2023/01/20/codeLMs/image-20230120173223547.png">
<meta property="og:image" content="http://ztrura.com/2023/01/20/codeLMs/image-20230120181342814.png">
<meta property="og:image" content="http://ztrura.com/2023/01/20/codeLMs/image-20230120185847376.png">
<meta property="og:image" content="http://ztrura.com/2023/01/20/codeLMs/image-20230120191933484.png">
<meta property="og:image" content="http://ztrura.com/2023/01/20/codeLMs/image-20230120192150106.png">
<meta property="og:image" content="http://ztrura.com/2023/01/20/codeLMs/image-20230120193527123.png">
<meta property="og:image" content="http://ztrura.com/2023/01/20/codeLMs/image-20230120193816788.png">
<meta property="og:image" content="http://ztrura.com/2023/01/20/codeLMs/image-20230120193852399.png">
<meta property="og:image" content="http://ztrura.com/2023/01/20/codeLMs/image-20230120194205393.png">
<meta property="og:image" content="http://ztrura.com/2023/01/20/codeLMs/image-20230120194238293.png">
<meta property="og:image" content="http://ztrura.com/2023/01/20/codeLMs/image-20230120194426517.png">
<meta property="og:image" content="http://ztrura.com/2023/01/20/codeLMs/image-20230120194514894.png">
<meta property="og:image" content="http://ztrura.com/2023/01/20/codeLMs/image-20230120194523923.png">
<meta property="og:image" content="http://ztrura.com/2023/01/20/codeLMs/image-20230120195131749.png">
<meta property="article:published_time" content="2023-01-20T14:33:35.000Z">
<meta property="article:modified_time" content="2023-11-20T10:19:39.448Z">
<meta property="article:author" content="Ztrura">
<meta property="article:tag" content="NL2PL">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://ztrura.com/2023/01/20/codeLMs/image-20230119133213886.png">
  
  
    <meta name="referrer" content="no-referrer-when-downgrade">
  
  
  <title>Code LMs - Ztrura</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"ztrura.com","root":"/","version":"1.9.4","typing":{"enable":true,"typeSpeed":100,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml"};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 6.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 60vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Ztrura</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                <span>首页</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                <span>归档</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                <span>分类</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                <span>标签</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                <span>关于</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/yourname.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="Code LMs"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2023-01-20 22:33" pubdate>
          2023年1月20日 晚上
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          6.3k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          32 分钟
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar category-bar" style="margin-right: -1rem">
    





<div class="category-list">
  
  
    
    
    
    <div class="category row nomargin-x">
      <a class="category-item 
          list-group-item category-item-action col-10 col-md-11 col-xm-11" title="学业"
        id="heading-a44ee9d422efe6c3240a19c9565dc303" role="tab" data-toggle="collapse" href="#collapse-a44ee9d422efe6c3240a19c9565dc303"
        aria-expanded="true"
      >
        学业
        <span class="list-group-count">(13)</span>
        <i class="iconfont icon-arrowright"></i>
      </a>
      
      <div class="category-collapse collapse show" id="collapse-a44ee9d422efe6c3240a19c9565dc303"
           role="tabpanel" aria-labelledby="heading-a44ee9d422efe6c3240a19c9565dc303">
        
        
          
          
  <div class="category-post-list">
    
    
      
      
        <a href="/2023/01/20/codeLMs/" title="Code LMs"
           class="list-group-item list-group-item-action
           active">
          <span class="category-post">Code LMs</span>
        </a>
      
    
      
      
        <a href="/2023/01/10/LanguageModels/" title="Language Models"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">Language Models</span>
        </a>
      
    
      
      
        <a href="/2023/01/13/LanguageModels2/" title="Language Models 补充"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">Language Models 补充</span>
        </a>
      
    
  </div>

          
  
    
    
    
    <div class="category-sub row nomargin-x">
      <a class="category-subitem collapsed
          list-group-item category-item-action col-10 col-md-11 col-xm-11" title="计算机网络实验"
        id="heading-677bc9451ef3a201841fd067aad087e8" role="tab" data-toggle="collapse" href="#collapse-677bc9451ef3a201841fd067aad087e8"
        aria-expanded="false"
      >
        计算机网络实验
        <span class="list-group-count">(10)</span>
        <i class="iconfont icon-arrowright"></i>
      </a>
      
      <div class="category-collapse collapse " id="collapse-677bc9451ef3a201841fd067aad087e8"
           role="tabpanel" aria-labelledby="heading-677bc9451ef3a201841fd067aad087e8">
        
        
          
  <div class="category-post-list">
    
    
      
      
        <a href="/2022/12/29/CNLab1-1/" title="lab1-1 Wireshark_Intro_v7.0"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">lab1-1 Wireshark_Intro_v7.0</span>
        </a>
      
    
      
      
        <a href="/2022/12/29/CNLab1-2/" title="lab1-2 Wireshark-protocal layers"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">lab1-2 Wireshark-protocal layers</span>
        </a>
      
    
      
      
        <a href="/2022/12/29/CNLab4-1/" title="lab4-1 Wireshark-ethernet"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">lab4-1 Wireshark-ethernet</span>
        </a>
      
    
      
      
        <a href="/2022/12/29/CNLab4-2/" title="lab4-2 Wireshark-80211"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">lab4-2 Wireshark-80211</span>
        </a>
      
    
      
      
        <a href="/2022/12/29/CNLab5-1/" title="lab5-1 Wireshark-ipv4"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">lab5-1 Wireshark-ipv4</span>
        </a>
      
    
      
      
        <a href="/2022/12/29/CNLab5-2/" title="lab5-2 Wireshark_ICMP"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">lab5-2 Wireshark_ICMP</span>
        </a>
      
    
      
      
        <a href="/2022/12/29/CNLab6-1/" title="lab6-1 Wireshark-TCP"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">lab6-1 Wireshark-TCP</span>
        </a>
      
    
      
      
        <a href="/2022/12/29/CNLab6-2/" title="lab6-2 Wireshark-UDP"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">lab6-2 Wireshark-UDP</span>
        </a>
      
    
      
      
        <a href="/2022/12/29/CNLab7-1/" title="lab7-1 Wireshark_DNS"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">lab7-1 Wireshark_DNS</span>
        </a>
      
    
      
      
        <a href="/2022/12/29/CNLab7-2/" title="lab7-2 Wireshark-HTTP"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">lab7-2 Wireshark-HTTP</span>
        </a>
      
    
  </div>

        
      </div>
    </div>
  
        
      </div>
    </div>
  
</div>


  </aside>


    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">Code LMs</h1>
            
            
              <div class="markdown-body">
                
                <h2 id="CodeX"><a href="#CodeX" class="headerlink" title="CodeX"></a>CodeX</h2><h3 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h3><p>在 GPT 模型基础上，使用 Github 上的代码做了微调。</p>
<p>（GPT-3 的卖点确实是不需要微调→为了模型创新性，但这里属于应用创新性，所以微调也无妨。</p>
<p>本质：GPT 在新的数据集上训练，得到新的应用。</p>
<h4 id="结果"><a href="#结果" class="headerlink" title="结果"></a>结果</h4><p><img src="image-20230119133213886.png" srcset="/img/loading.gif" lazyload alt="image-20230119133213886"></p>
<p>生成一个答案：28.8%；跑一百遍，利用单元测试（文档+单元测试的人工工作量过大，不现实）得出最优解：77.5%；100次运行+利用给出的排序算法自动给出最优解：44.5%。</p>
<p>模型↑，准确率↑。</p>
<h4 id="验证集"><a href="#验证集" class="headerlink" title="验证集"></a>验证集</h4><p>human-eval: 164个编程问题，如算法问题、简单的数学问题、软件面试问题等。</p>
<p><img src="image-20230119212019266.png" srcset="/img/loading.gif" lazyload alt="image-20230119212019266"></p>
<p>164个问题，每个问题都提供了函数的签名、文档、实现和多个单元测试（平均每个问题7.7个）。</p>
<p>均为手动实现→防止代码已出现在训练集中。</p>
<h3 id="详细"><a href="#详细" class="headerlink" title="详细"></a>详细</h3><h4 id="评估框架"><a href="#评估框架" class="headerlink" title="评估框架"></a>评估框架</h4><h5 id="正确性的评估"><a href="#正确性的评估" class="headerlink" title="正确性的评估"></a>正确性的评估</h5><h6 id="往往采用"><a href="#往往采用" class="headerlink" title="往往采用"></a>往往采用</h6><p>BLEU score：生成序列与真正的标号序列在一些子序列上的相似度，是一种模糊的匹配。BLEU score无法胜任代码匹配的评估上。</p>
<h6 id="该模型采用"><a href="#该模型采用" class="headerlink" title="该模型采用"></a>该模型采用</h6><p>pass@k metric: k 表示可以生成 k 个不同结果，有一个正确就视为正确。</p>
<h6 id="流程"><a href="#流程" class="headerlink" title="流程"></a>流程</h6><p>生成 n (n&gt;k) 个样本，然后每次从里面随机采 k 个出来（因为重复生成 k 个样本太贵了），看是否有正确答案。</p>
<p><img src="image-20230119162657083.png" srcset="/img/loading.gif" lazyload alt="image-20230119162657083"></p>
<p>E 表示对164个值求平均，c 表示正确个数。</p>
<p>（公式虽然简单，但数很大时，计算量过大，这里采取了一定处理避免超限（把组合数化简）。</p>
<h6 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h6><p>k较大时，结果会过于乐观；结果的排序很重要，但这里无法对排序进行评估。</p>
<p>后续会讨论。</p>
<h5 id="验证集-1"><a href="#验证集-1" class="headerlink" title="验证集"></a>验证集</h5><h5 id="运行代码的沙盒"><a href="#运行代码的沙盒" class="headerlink" title="运行代码的沙盒"></a>运行代码的沙盒</h5><p>类似虚拟机。</p>
<p>防止恶意代码影响机器。</p>
<h4 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h4><h5 id="数据的收集"><a href="#数据的收集" class="headerlink" title="数据的收集"></a>数据的收集</h5><p>179 GB python 文件，清洗得到 159 GB。</p>
<p>问题：没有关注代码的开源协议。</p>
<h5 id="模型"><a href="#模型" class="headerlink" title="模型"></a>模型</h5><p>从 GPT-3 微调→精度上竟然没有提升（可能是因为微调的数据集过大），但收敛速度快，也就这样做下去了。</p>
<h5 id="分词"><a href="#分词" class="headerlink" title="分词"></a>分词</h5><h6 id="空格"><a href="#空格" class="headerlink" title="空格"></a>空格</h6><p>代码中词的分布与自然语言中词的分布有很大区别，所以 GPT-3 的分词器在表示代码时不够有效。效率低下的一个主要原因是空格的编码，因此这里在 GPT-3 的分词器的基础上加入了额外的一系列 tokens用来表示不同长度的空格，这样在表示代码时可以少使用30%的token。</p>
<h6 id="停止符"><a href="#停止符" class="headerlink" title="停止符"></a>停止符</h6><p>生成答案时，遇到 ”\nclass“, ”\ndef“, ”\n#“, ”\nif“, or ”\nprint“ 时停止。</p>
<h6 id="核采样"><a href="#核采样" class="headerlink" title="核采样"></a>核采样</h6><ol>
<li>一般采样：每次做序列生成时，将当前序列放进模型，得到当前最好的单词，但：无法保证全局最优；每次得到的输出都确定，无论运行多少遍得到的结果都相同。</li>
<li>改进：Beam Search（束搜索），维护32个或128个当前最好的候选。</li>
<li>核采样：构造一个最小候选集，使得：<script type="math/tex">\sum_{x \in V} P(x)>p</script> （文章中 p 取了0.95），然后重新归一化集合内词的概率，作为候选集。</li>
</ol>
<p>优点：保证了结果多样性的同时过滤掉了特别不靠谱的词。</p>
<h4 id="结果-1"><a href="#结果-1" class="headerlink" title="结果"></a>结果</h4><h5 id="模型大小与测试损失的关系"><a href="#模型大小与测试损失的关系" class="headerlink" title="模型大小与测试损失的关系"></a>模型大小与测试损失的关系</h5><p><img src="image-20230119212722494.png" srcset="/img/loading.gif" lazyload alt="image-20230119212722494"></p>
<h5 id="不同-Temperature-下，样本数量与-pass-k-的关系"><a href="#不同-Temperature-下，样本数量与-pass-k-的关系" class="headerlink" title="不同 Temperature 下，样本数量与 pass@k 的关系"></a>不同 Temperature 下，样本数量与 pass@k 的关系</h5><p><img src="image-20230119213418011.png" srcset="/img/loading.gif" lazyload alt="image-20230119213418011"></p>
<p>Temperature：将单词数列输出除以 temperature，达到调和概率值的目的。</p>
<p>样本数量较大时，温度越高效果越好→这可能是由于样本多样性的增加。</p>
<h5 id="不同样本数量下的最佳-Temperature"><a href="#不同样本数量下的最佳-Temperature" class="headerlink" title="不同样本数量下的最佳 Temperature"></a>不同样本数量下的最佳 Temperature</h5><p><img src="image-20230119214821833.png" srcset="/img/loading.gif" lazyload alt="image-20230119214821833"></p>
<h5 id="排序算法的比较"><a href="#排序算法的比较" class="headerlink" title="排序算法的比较"></a>排序算法的比较</h5><p><img src="image-20230119215407301.png" srcset="/img/loading.gif" lazyload alt="image-20230119215407301"></p>
<p>Oracle：在单元测试上测完后再排序得到结果，现实实现不现实。</p>
<p>Mean logp：把每个解中的候选词在 softmax 上的概率作 log 运算后再求均值，将均值最高的解作为结果。</p>
<h5 id="用-BLEU-score-对正确-错误的解决方案进行打分"><a href="#用-BLEU-score-对正确-错误的解决方案进行打分" class="headerlink" title="用 BLEU score 对正确/错误的解决方案进行打分"></a>用 BLEU score 对正确/错误的解决方案进行打分</h5><p><img src="image-20230119220636853.png" srcset="/img/loading.gif" lazyload alt="image-20230119220636853"></p>
<p>发现其很难正确区分解决方案是正确的还是错误的。</p>
<h5 id="CodeX-S"><a href="#CodeX-S" class="headerlink" title="CodeX-S"></a>CodeX-S</h5><p><img src="image-20230120110246895.png" srcset="/img/loading.gif" lazyload alt="image-20230120110246895"></p>
<p><img src="image-20230120110346153.png" srcset="/img/loading.gif" lazyload alt="image-20230120110346153"></p>
<h4 id="CodeX-S-1"><a href="#CodeX-S-1" class="headerlink" title="CodeX-S"></a>CodeX-S</h4><h5 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h5><p>训练集为 Github 上爬下来的代码，评估是根据一些写好的注释来预测实现，二者形式不统一。</p>
<h5 id="方法"><a href="#方法" class="headerlink" title="方法"></a>方法</h5><p>收集了新的数据集（Supervised Fine-Tuning 数据集），该数据集与评估集形式相近。</p>
<p>在新数据集上微调得到 CodeX-S。</p>
<h5 id="效果"><a href="#效果" class="headerlink" title="效果"></a>效果</h5><p>只生成一个答案：28.8%→37.7%。</p>
<h4 id="CodeX-D"><a href="#CodeX-D" class="headerlink" title="CodeX-D"></a>CodeX-D</h4><p>函数实现→实验文档。</p>
<h5 id="数据集"><a href="#数据集" class="headerlink" title="数据集"></a>数据集</h5><p>调整了训练集数据的顺序，将注释放到最后。</p>
<h5 id="验证"><a href="#验证" class="headerlink" title="验证"></a>验证</h5><ol>
<li>人眼看；</li>
<li>先用CodeX-D生成文档，再用文档和函数签名生成函数实现，看结果能否过单元测试。</li>
</ol>
<p><img src="image-20230120111612158.png" srcset="/img/loading.gif" lazyload alt="image-20230120111612158"></p>
<h4 id="局限性"><a href="#局限性" class="headerlink" title="局限性"></a>局限性</h4><ul>
<li><p>样本有效性不够，需要看很多代码才能写比较简单的代码。</p>
</li>
<li><p>docstrings 的书写规范。定义了多个测试单元，发现链接的单元越多（docstrings 越长），通过率越低（指数级下降）。</p>
<p><img src="image-20230120111857932.png" srcset="/img/loading.gif" lazyload alt="image-20230120111857932"></p>
</li>
<li><p>处理数学问题的能力较差。</p>
<p><img src="image-20230120112147169.png" srcset="/img/loading.gif" lazyload alt="image-20230120112147169"></p>
</li>
</ul>
<h4 id="影响"><a href="#影响" class="headerlink" title="影响"></a>影响</h4><ul>
<li>bug</li>
<li>Github 男性用户居多→性别歧视问题</li>
<li>替代人工的社会性问题</li>
<li>恶意使用</li>
<li>……</li>
</ul>
<h2 id="PolyCoder"><a href="#PolyCoder" class="headerlink" title="PolyCoder"></a>PolyCoder</h2><p>在代码上训练的语言模型越来越多，考虑到这些模型中涉及的模型大小和训练方案的多样性，以及这些模型之间缺乏比较，许多建模和训练设计决策的影响仍不清楚。本文对现有的跨各种编程语言的代码模型——Codex、GPT-J、GPT-Neo、GPT-NeoX和CodeParrot——进行了系统评估并发布了PolyCoder模型，该模型基于 GPT-2 架构并在12种编程语言上进行预训练。</p>
<p><img src="image-20230120112947452.png" srcset="/img/loading.gif" lazyload alt="image-20230120112947452"></p>
<p>PPL结果如图6所示，PolyCoder在C语言中优于Codex和所有其他模型。仅比较开源模型，PolyCoder在C、JavaScript、Rust、Scala和TypeScript中的性能要优于类似大小的GPT-Neo 2.7B。</p>
<p>在除C语言之外的11种语言中，所有其他开源模型，包括PolyCoder，都明显比Codex更糟糕。这可能是因为PolyCoder是在不同语言的不平衡混合上训练的，C和C++密切相关，并且在整个训练语料库中占主导地位。因此，较大的总容量(因为长文件)使C语言成为PolyCoder最“青睐”的语言。PolyCoder在c++中表现不如Codex的原因可能是由于c++语言的复杂性和Codex的上下文窗口大小明显较长(4096，而PolyCoder的2048)，或者因为Codex可能在更多的c++训练数据上进行训练。</p>
<p>资源：<a target="_blank" rel="noopener" href="https://github.com/2FVHellendoorn/2FCode-LMs">https://github.com/2FVHellendoorn/2FCode-LMs</a></p>
<h2 id="Synchromesh"><a href="#Synchromesh" class="headerlink" title="Synchromesh"></a>Synchromesh</h2><p>Synchromesh: 齿轮的同时咬合装置。</p>
<h4 id="Motivation"><a href="#Motivation" class="headerlink" title="Motivation"></a>Motivation</h4><p>大模型虽好，但它们在code generation任务中：</p>
<ul>
<li><p>可能错误地意会 developer 的 intent</p>
</li>
<li><p>生成跑不起来的代码</p>
</li>
<li><p>无法通过仅扩大模型规模来提升性能的可靠性</p>
</li>
</ul>
<h4 id="Approach"><a href="#Approach" class="headerlink" title="Approach"></a>Approach</h4><h5 id="framework"><a href="#framework" class="headerlink" title="framework"></a>framework</h5><p><img src="image-20230120125043513.png" srcset="/img/loading.gif" lazyload alt="image-20230120125043513"></p>
<p>SYNCHROMESH框架概述。对于用户的查询，首先使用目标相似度调优(Target Similarity Tuning, TST)检索高相关性示例。然后，通过约束语义解码(Constrained Semantic Decoding, CSD)对程序进行增量采样，它查询补全引擎(Completion Engine, CE)以在代码生成期间强制执行约束，而无需重新训练或微调语言模型。</p>
<h5 id="TST"><a href="#TST" class="headerlink" title="TST"></a>TST</h5><p><img src="image-20230120125212608.png" srcset="/img/loading.gif" lazyload alt="image-20230120125212608"></p>
<p>目标相似度调优改进了合成SOL查询的示例选择的例子。在(a)中，提示示例遗漏了关键查询结构(分组和计数)。对于这个例子，GPT-3生成了一个无效的查询(b)。对于TST，检索了一个相关的例子，GPT-3成功地适应了这个例子来回答用户的问题(c)。</p>
<p>（Sentence-Bert：语义相似度计算。</p>
<p>ab 流程失败原因：基于了描述相似性而不是 SQL 查询的相似性（简单描述：形式上相似，但逻辑上不相似）。比如在这里，所选示例中的SQL查询的结构过于简单，与所需 SQL 查询的结构有很大的不同。</p>
<p>加入 TST：</p>
<p>$D$ 是程序和相关表达的数据集，$D<em>i=(p_i,u_i)$ 。$S(p_a,p_b)∈[0,1]$ 表示程序之间的归一化相似度度量。 如果 $f</em>\theta$ 是一个预训练好的自然语句相似度模型，那么 TST 就是对 $f$ 进行微调来根据 $S$ 给出的目标程序的描述来预测目标程序之间的相似度。最后，将均方误差损失最小化：</p>
<p><img src="image-20230120134330476.png" srcset="/img/loading.gif" lazyload alt="image-20230120134330476"></p>
<p>论文中使用了 classical tree edit distance algorithm 来定义 $S$ 以比较抽象语法树（Abstract Syntax Trees）。</p>
<p>对应 ac 流程，可以发现问题和示例的表述在自然语言中完全不同，但它们在所描述的SQL查询中具有相似性。</p>
<h5 id="CSD-amp-CE"><a href="#CSD-amp-CE" class="headerlink" title="CSD &amp; CE"></a>CSD &amp; CE</h5><p>TST 只能引导 LLMs 走向正确的结构，无法保证正确地填充所有具体的实现细节。</p>
<p><img src="image-20230120161144651.png" srcset="/img/loading.gif" lazyload alt="image-20230120161144651"></p>
<p>可以看到，a 中生成反了（一般来说，无约束语言模型经常犯这样的错误：使用未声明的变量、在生成复杂表达式时失去对嵌套级别的追踪或者使用错误类型的参数调用函数，而即使是最小的错误也会阻止生成的代码执行）。</p>
<p>CSD 通过构造(而不是事后修复)来防止实现错误。假设我们可以访问一个 oracle（我们称之为 CE），它可以接受一个部分程序并返回所有 tokens ，这些 tokens 可以将该部分程序扩展为一个完整的正确程序。当LLM逐个 tokens 生成程序时，CSD 确保从 CE 返回的集合中采样下一个 tokens 。如上图，在“on”子句中生成“T1.”之后，SQL CE解析名称并约束模型输出“Flights”表中的一列。这将修复先前在生成过程中看到的错误，并生成正确的SQL查询。</p>
<p>给定一个部分程序，CE 将返回一个正则表达式，该正则表达式与后面的有效 tokens 匹配。</p>
<p>CE 本质上是对 Decoder 的输出词表分布做了限制。CE 为人工实现。</p>
<p><img src="image-20230120171251115.png" srcset="/img/loading.gif" lazyload alt="image-20230120171251115"></p>
<p>（DoB: Date of Birth.</p>
<h4 id="Experiments"><a href="#Experiments" class="headerlink" title="Experiments"></a>Experiments</h4><p><img src="image-20230120173223547.png" srcset="/img/loading.gif" lazyload alt="image-20230120173223547"></p>
<p>Exec. 和 Acc. 都表示匹配精度。</p>
<h4 id="Results"><a href="#Results" class="headerlink" title="Results"></a>Results</h4><ul>
<li>在decoding阶段动态执行 constrain，表现比 generate-then-test 好。</li>
<li>显著提高了生成代码的合法性；有助于生成更长的代码。</li>
<li>使用 SYNCHROMESH 方法增强的LLMs表现不如监督模型，但比 CodeX 好。</li>
</ul>
<h2 id="Jigsaw"><a href="#Jigsaw" class="headerlink" title="Jigsaw"></a>Jigsaw</h2><p>Jigsaw是多模态的（如下图所示），它可以通过输入表示意图的自然语言字符串或一组输入-输出示例来生成作为输出的代码片段。</p>
<p><img src="image-20230120181342814.png" srcset="/img/loading.gif" lazyload alt="image-20230120181342814"></p>
<h4 id="Contributions"><a href="#Contributions" class="headerlink" title="Contributions"></a>Contributions</h4><ul>
<li>提出了一种架构，通过使用基于程序分析和合成的技术和多模态规范来增强黑盒ptlm来执行代码合成。已经在一个叫做Jigsaw的工具中实现了架构。已经开发了一个Jupyter笔记本扩展，允许用户与系统无缝交互。</li>
<li>描述了ptlm所犯的常见错误类别，即引用错误、参数错误和语义错误。基于这些错误，在Jigsaw中设计了程序分析和合成技术，以修复由ptlm生成的代码片段中的此类错误。还设计了从用户反馈中学习的技术，并随着使用而改进。</li>
<li>已经创建了两个具有多模态规范的Pandas数据集(在补充材料中提供，并将发布给社区使用)。通过使用两个最先进的PTLMs，发现与两个数据集上的基线相比Jigsaw的精度显著提高。</li>
</ul>
<h4 id="Architecture"><a href="#Architecture" class="headerlink" title="Architecture"></a>Architecture</h4><p><img src="image-20230120185847376.png" srcset="/img/loading.gif" lazyload alt="image-20230120185847376"></p>
<p>核心：post-processing 阶段。包括特征、转换错误的代码片段、从用户反馈中改进。</p>
<h5 id="Pre-trained-Language-Models"><a href="#Pre-trained-Language-Models" class="headerlink" title="Pre-trained Language Models"></a>Pre-trained Language Models</h5><p><img src="image-20230120191933484.png" srcset="/img/loading.gif" lazyload alt="image-20230120191933484"></p>
<h5 id="Pre-processing"><a href="#Pre-processing" class="headerlink" title="Pre-processing"></a>Pre-processing</h5><p><img src="image-20230120192150106.png" srcset="/img/loading.gif" lazyload alt="image-20230120192150106"></p>
<p>维护一个包含可能的问答对的上下文库（Jigsaw通过从Pandas的API文档中抓取和注释示例，以及用于教授API的其他示例资源(来自教程等)，离线创建了一个上下文银行。），然后从上下文库中选择与当前查询相似的元素，并将这些元素添加到上下文中。当用户提出一个问题时，该问题将被馈送到上下文选择器，上下文选择器使用文本相似度度量从上下文库中挑选最相关的提示。</p>
<p>在Jigsaw无法产生正确答案的情况下，让用户对不正确的Jigsaw代码进行更改，并使用这样的反馈来增强上下文银行。</p>
<p>ptlm还接受一个称为温度的输入参数。温度越低，准确的答案就越少。数值越高，得到的答案就越不准确，但也就越多样。</p>
<h5 id="Post-processing"><a href="#Post-processing" class="headerlink" title="Post-processing"></a>Post-processing</h5><p>Jigsaw 的后处理步骤的目标是过滤和转换 PTLM 产生的输出，以产生正确的答案。</p>
<p>衡量正确性的标准是生成的代码应该通过用户指定的 I/O 示例。</p>
<p>大约30%-60%的情况(取决于 PTLM 和数据集)，PTLM 产生正确的输出。在其余的情况下，Jigsaw 使用PTLM生成的候选解决方案作为起点，并使用简单的程序分析和综合技术对候选代码片段执行转换，以生成正确的解决方案。</p>
<h6 id="Correctness-checks"><a href="#Correctness-checks" class="headerlink" title="Correctness checks"></a>Correctness checks</h6><p>在有I/O示例的情况下，我们从每个指定的示例输入开始运行候选代码段，并检查所产生的输出是否与相应的指定输出一致。</p>
<h6 id="Variable-Name-transformations"><a href="#Variable-Name-transformations" class="headerlink" title="Variable Name transformations"></a>Variable Name transformations</h6><p>在某些情况下，PTLM 生成了准确的代码片段，但是使用了不正确的变量名。由于用户在自然语言描述或测试用例中指定输入和输出变量，这个后处理步骤使用来自多模态输入的这些信息，以及范围内的变量名，通过系统地搜索潜在变量，并尝试变量名的可能排列和组合，以通过测试用例。</p>
<p><img src="image-20230120193527123.png" srcset="/img/loading.gif" lazyload alt="image-20230120193527123"></p>
<h6 id="Argument-transformations"><a href="#Argument-transformations" class="headerlink" title="Argument transformations"></a>Argument transformations</h6><p>在某些情况下，PTLM 生成的代码片段带有正确的方法名称和方法序列，但是带有不正确的参数。</p>
<blockquote>
<p>replace ‘United States’ in ‘location’ by ‘US’ and ‘3434’ in ‘zip’ by ‘4343’</p>
</blockquote>
<p><img src="image-20230120193816788.png" srcset="/img/loading.gif" lazyload alt="image-20230120193816788"></p>
<p>应该为：</p>
<p><img src="image-20230120193852399.png" srcset="/img/loading.gif" lazyload alt="image-20230120193852399"></p>
<p>“在这种情况下，这个后处理步骤系统地从推断的参数空间中搜索给定方法/函数名序列的参数。为了在参数空间上实现系统搜索，我们采用Autopandas工具[9]所使用的方法，并进行了以下修改。Autopandas使用图形神经网络，将I/O示例作为输入，来选择方法名。然而，我们需要大量特定领域的数据来训练这样的神经网络。在我们的例子中，我们简单地从PTLM的输出中提取方法名，给定自然语言查询(这很容易扩展到Pandas以外的编程领域)。执行搜索的参数空间是通过使用自然语言文本输入、PTLM输出中的参数、数据帧模式中的列名以及作用域中的变量推断出来的。我们扩展了Autopandas中的生成器，以考虑复杂的数据类型，如列表和字典，并且我们扩展了考虑的api集，除了返回Pandas数据框架类型的api外，还包括返回Pandas系列类型(能够保存任何类型数据的一维标记数组)的api。通过这些修改，我们发现Jigsaw能够将PTLM生成的一些错误代码片段转换为正确的代码片段(如第5节所示)。”</p>
<h6 id="AST-to-AST-transformations"><a href="#AST-to-AST-transformations" class="headerlink" title="AST-to-AST transformations"></a>AST-to-AST transformations</h6><p>有时候会反复犯一些小错误，可以通过适当的AST-to-AST转换进行修复，这是从用户与Jigsaw的交互中学习到的。</p>
<p>作为一个具体的例子，我们发现GPT-3经常忽略按位的not操作符，并产生如下代码:</p>
<p><img src="image-20230120194205393.png" srcset="/img/loading.gif" lazyload alt="image-20230120194205393"></p>
<p>而不是：</p>
<p><img src="image-20230120194238293.png" srcset="/img/loading.gif" lazyload alt="image-20230120194238293"></p>
<p>（文章中的小错误：</p>
<p><img src="image-20230120194426517.png" srcset="/img/loading.gif" lazyload alt="image-20230120194426517"></p>
<p><img src="image-20230120194514894.png" srcset="/img/loading.gif" lazyload alt="image-20230120194514894"></p>
<p>而不是：</p>
<p><img src="image-20230120194523923.png" srcset="/img/loading.gif" lazyload alt="image-20230120194523923"></p>
<h5 id="Learning-from-user-feedback"><a href="#Learning-from-user-feedback" class="headerlink" title="Learning from user feedback"></a>Learning from user feedback</h5><p>Jigsaw的用户界面(集成到 Jupyter notebook 中)旨在让用户在 Jigsaw 错误的情况下提交正确的代码。Jigsaw可以通过吸收用户反馈进行改进。具体来说，当更多用户与Jigsaw交互时，作者设计了用于在预处理模块中更新上下文银行和在后处理步骤中进行AST-to-AST转换的技术。</p>
<h2 id="Data2Vis"><a href="#Data2Vis" class="headerlink" title="Data2Vis"></a>Data2Vis</h2><h4 id="主要工作"><a href="#主要工作" class="headerlink" title="主要工作"></a>主要工作</h4><ol>
<li>将可视化设计表述为序列翻译问题的序列；</li>
<li>在小规模的训练集上训练模型，然后有效生成测试数据的可视化，展示其可行性；</li>
<li>开源的基于web的应用程序Data2Vis.</li>
</ol>
<p>本文是第一个将深层神经翻译运用到可视化生成中的研究，之后的研究可以考虑从大规模数据中隐式的学习可视化设计和可视化分析规则。</p>
<h4 id="模型-1"><a href="#模型-1" class="headerlink" title="模型"></a>模型</h4><p><img src="image-20230120195131749.png" srcset="/img/loading.gif" lazyload alt="image-20230120195131749"></p>
<p>将数据可视化问题表述为一个序列到序列的翻译问题（seq2seq），我们输入序列是数据集（json格式），输出序列是一个有效的Vega-lite可视化格式。</p>
<p>为了能将seq2seq模型运用到非序列问题中，研究考虑使用双向RNN和注意力机制。</p>
<p>模型的基础是一个添加注意力机制的编码器-解码器架构。编码器是一个双向RNN。解码器就是基于编码器的输出结果去计算目标序列的概率的RNN。这个概率和解码器RNN的结果，目标序列之前的结果，以及注意力向量（context vector）有关。</p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/%E5%AD%A6%E4%B8%9A/" class="category-chain-item">学业</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/NL2PL/">#NL2PL</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>Code LMs</div>
      <div>http://ztrura.com/2023/01/20/codeLMs/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>ztrura</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2023年1月20日</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2023/01/20/230120/" title="开组会有感">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">开组会有感</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2023/01/17/230117/" title="关于快节奏化的一些思考">
                        <span class="hidden-mobile">关于快节奏化的一些思考</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目录</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  


  
  









    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <!--<i class="iconfont icon-love"></i>--> <a>&</a> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> <div style="font-size: 0.85rem"> <span id="timeDate">载入天数...</span> <span id="times">载入时分秒...</span> <script src="/js/duration.js"></script> </div> 
    </div>
  
  
    <div class="statistics">
  
  

  
    
      <span id="busuanzi_container_site_pv" style="display: none">
        总访问量 
        <span id="busuanzi_value_site_pv"></span>
         次
      </span>
    
    
      <span id="busuanzi_container_site_uv" style="display: none">
        总访客数 
        <span id="busuanzi_value_site_uv"></span>
         人
      </span>
    
    
  
</div>

  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  
      <script>
        if (!window.MathJax) {
          window.MathJax = {
            tex    : {
              inlineMath: { '[+]': [['$', '$']] }
            },
            loader : {
              load: ['ui/lazy']
            },
            options: {
              renderActions: {
                insertedScript: [200, () => {
                  document.querySelectorAll('mjx-container').forEach(node => {
                    let target = node.parentNode;
                    if (target.nodeName.toLowerCase() === 'li') {
                      target.parentNode.classList.add('has-jax');
                    }
                  });
                }, '', false]
              }
            }
          };
        } else {
          MathJax.startup.document.state(0);
          MathJax.texReset();
          MathJax.typeset();
          MathJax.typesetPromise();
        }

        Fluid.events.registerRefreshCallback(function() {
          if ('MathJax' in window && MathJax.startup.document && typeof MathJax.startup.document.state === 'function') {
            MathJax.startup.document.state(0);
            MathJax.texReset();
            MathJax.typeset();
            MathJax.typesetPromise();
          }
        });
      </script>
    

  <script  src="https://lib.baomitu.com/mathjax/3.2.2/es5/tex-mml-chtml.js" ></script>

  <script  src="/js/local-search.js" ></script>

  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
